chmod +x /home/jiayen/Desktop/pet_project/backend/run_cron_decay.sh

cat /home/jiayen/Desktop/pet_project/backend/cron/energy_decay.log
/home/jiayen/Desktop/pet_project/backend/run_cron_decay.sh

sudo apt install dos2unix
dos2unix /home/jiayen/Desktop/pet_project/backend/run_cron_decay.sh

# 體力下降 (每20分鐘執行一次)
*/20 * * * * /home/jiayen/Desktop/pet_project/backend/run_cron_decay.sh >> /home/jiayen/Desktop/pet_project/backend/cron/energy_decay.log 2>&1

# 排行榜更新 (每30分鐘執行一次)
*/30 * * * * /home/jiayen/Desktop/pet_project/backend/venv/bin/python /home/jiayen/Desktop/pet_project/backend/cron/update_leaderboard.py >> /home/jiayen/Desktop/pet_project/backend/cron/leaderboard.log 2>&1

---

# 每 20 分鐘：體力自然下降 & 體力為 0 扣分
*/20 * * * * /usr/bin/python3 /home/jiayen/Desktop/pet_project/cron/energy_decay.py >> /home/jiayen/Desktop/pet_project/cron/energy_decay.log 2>&1

# 每 15 分鐘：重算排行榜並寫入 leaderboard table
*/30 * * * * /usr/bin/python3 /home/jiayen/Desktop/pet_project/cron/update_leaderboard.py >> /home/jiayen/Desktop/pet_project/cron/leaderboard.log 2>&1

# 設置執行環境
SHELL=/bin/bash
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin

*/20 * * * * cd /home/jiayen/Desktop/pet_project/backend && /home/jiayen/Desktop/pet_project/backend/venv/bin/python cron/energy_decay.py >> /home/jiayen/Desktop/pet_project/backend/cron/energy_decay.log 2>&1
*/30 * * * * cd /home/jiayen/Desktop/pet_project/backend && /home/jiayen/Desktop/pet_project/backend/venv/bin/python cron/update_leaderboard.py >> /home/jiayen/Desktop/pet_project/backend/cron/leaderboard.log 2>&1

#步驟一
# 測試排程與日誌輸出是否正常 (每分鐘執行一次)

* * * * * echo "Cron Test $(date)" >> /tmp/cron_test_global.log 2>&1
* * * * * /bin/echo "Cron Test - Path Check $(/bin/date)" >> /tmp/cron_test_abs_path.log 2>&1
# 暫時註解您的 Python 腳本
# */20 * * * * cd /home/jiayen/Desktop/pet_project/backend && ...

# 等待一分鐘

cat /tmp/cron_test_global.log

# 如果沒有輸出
sudo chown jiayen:jiayen /home/jiayen/Desktop
chmod 755 /home/jiayen/Desktop

# 步驟二
# 手動測試 Cron 命令的精確路徑
cd /home/jiayen/Desktop/pet_project/backend && /home/jiayen/Desktop/pet_project/backend/venv/bin/python cron/energy_decay.py









